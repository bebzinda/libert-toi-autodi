<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Outils | Libert_Toi_AutoDi</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="css/style.css">
<style>
.cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px,1fr)); gap:20px; padding:20px; }
.card { background:white; padding:25px; border-radius:15px; box-shadow:0 10px 25px rgba(0,0,0,0.08);}
.btn { display:inline-block; padding:12px 20px; color:white; text-decoration:none; border-radius:6px; cursor:pointer;}
.btn.download { background:#28a745;}
.btn.whatsapp { background:#25d366;}
.btn.disabled { background:#6c757d; cursor:not-allowed;}
</style>
</head>
<body>

<header class="site-header">
  <h1>Outils Ã  tÃ©lÃ©charger</h1>
</header>

<nav class="navbar">
  <a href="index.html">Accueil</a>
  <a href="formations.html">Formations</a>
  <a href="outils.html">Outils</a>
  <a href="espace-client.html">Espace Client</a>
</nav>

<main class="cards">
  <!-- Gratuit -->
  <div class="card">
    <h3>ðŸ“Š Excel â€“ Gestion Gratuite</h3>
    <p>Fichier Excel prÃªt Ã  lâ€™emploi.</p>
    <a href="docs/excel.xlsx" download class="btn download">ðŸ“¥ TÃ©lÃ©charger Gratuitement</a>
  </div>

  <!-- Payant -->
  <div class="card">
    <h3>ðŸ“Š Excel â€“ Gestion AvancÃ©e (Payant)</h3>
    <p>Fichier complet pour usage professionnel.</p>
    <button class="btn whatsapp" onclick="commander('Excel â€“ Gestion AvancÃ©e')">ðŸ’¬ Commander via WhatsApp</button>
    <a id="link-excel" href="#" class="btn download disabled">ðŸ“¥ TÃ©lÃ©charger</a>
  </div>
</main>

<script>
const ENDPOINT = "https://script.google.com/macros/s/AKfycbxKymOFmez4Oz6opGEPo909UWvkQh8EcVmKpB456FTuF64L3fIVSlBntz1a0ID78N0/exec";

async function commander(outil){
  const nom = prompt("Votre nom complet :");
  if(!nom) return alert("Nom requis");
  const email = prompt("Votre email :");
  if(!email) return alert("Email requis");
  const whatsapp = prompt("Votre numÃ©ro WhatsApp :");
  if(!whatsapp) return alert("WhatsApp requis");

  try {
    const res = await fetch(`${ENDPOINT}?action=creer&outil=${encodeURIComponent(outil)}&nom=${encodeURIComponent(nom)}&email=${encodeURIComponent(email)}&whatsapp=${encodeURIComponent(whatsapp)}`);
    const data = await res.json();
    if(data.status !== "OK") return alert("Erreur crÃ©ation commande : " + (data.message || "IndÃ©terminÃ©e"));

    const code = data.code;
    const message = `Bonjour,%0AJe souhaite commander:%0A- Outil: ${outil}%0A- Nom: ${nom}%0A- Email: ${email}%0A- Code: ${code}`;
    window.open(`https://wa.me/22665219538?text=${message}`, "_blank");

    alert(`Commande crÃ©Ã©e âœ…\nVous recevrez un email dÃ¨s que le lien de tÃ©lÃ©chargement sera renseignÃ©.\nCode : ${code}`);
  } catch(e) {
    console.error(e);
    alert("Erreur de communication avec le serveur.");
  }
}
</script>
</body>
</html>